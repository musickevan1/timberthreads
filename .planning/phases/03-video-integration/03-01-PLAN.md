---
phase: 03-video-integration
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - public/assets/videos/hero-background.mp4
  - public/assets/videos/hero-poster.jpg
  - public/assets/videos/promo-full.mp4
  - public/assets/videos/promo-poster.jpg
autonomous: false
user_setup:
  - service: ffmpeg
    why: "Video compression and poster extraction"
    installation:
      - task: "Install FFmpeg if not already available"
        instructions: |
          macOS: brew install ffmpeg
          Linux: apt-get install ffmpeg or yum install ffmpeg
          Windows: Download from https://ffmpeg.org/download.html
    dashboard_config: []

must_haves:
  truths:
    - "Hero background video file exists and is under 5MB"
    - "Full promo video file exists and is under 10MB"
    - "Both videos have high-quality poster images extracted"
    - "Video files are in web-optimized format (H.264, faststart flag)"
  artifacts:
    - path: "public/assets/videos/hero-background.mp4"
      provides: "Compressed hero background video clip"
      max_size: "5MB"
    - path: "public/assets/videos/promo-full.mp4"
      provides: "Compressed full promo video"
      max_size: "10MB"
    - path: "public/assets/videos/hero-poster.jpg"
      provides: "Poster fallback for hero video"
      min_quality: "High (q:v 2)"
    - path: "public/assets/videos/promo-poster.jpg"
      provides: "Poster fallback for promo video"
      min_quality: "High (q:v 2)"
  key_links:
    - from: "FFmpeg compression"
      to: "public/assets/videos/*.mp4"
      via: "CLI commands with CRF 23, movflags +faststart"
      pattern: "ffmpeg.*-movflags \\+faststart"
---

<objective>
Prepare video files for web integration by compressing raw footage and extracting poster images.

Purpose: Reduce file sizes to meet performance requirements (<10MB total) while maintaining visual quality for hero background and full promo video.

Output: Web-optimized video files (MP4 with H.264) and high-quality poster images (JPG) ready for self-hosting.
</objective>

<execution_context>
@/home/evan/.claude/get-shit-done/workflows/execute-plan.md
@/home/evan/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/research/phase-3-RESEARCH.md
</context>

<tasks>

<task type="checkpoint:human-action" gate="blocking">
  <name>Compress video files and extract poster images using FFmpeg</name>
  <action>Compress and prepare video files using FFmpeg after Feb 15 shoot</action>
  <what-human-does>
After the Feb 15 video shoot is complete and footage is edited:

1. **Select hero background clip** (15-30 seconds from drone footage)
   - Choose visually engaging aerial shot with good composition
   - Avoid clips with rapid motion or camera shake

2. **Create video directory:**
   ```bash
   mkdir -p public/assets/videos
   ```

3. **Compress hero background video** (target <5MB, 720p):
   ```bash
   ffmpeg -i [path-to-hero-clip.mp4] \
     -c:v libx264 \
     -crf 23 \
     -preset medium \
     -vf "scale=1280:720:force_original_aspect_ratio=decrease,pad=1280:720:-1:-1:color=black" \
     -r 30 \
     -movflags +faststart \
     -c:a aac \
     -b:a 128k \
     public/assets/videos/hero-background.mp4
   ```

4. **Compress full promo video** (target <10MB, 1080p):
   ```bash
   ffmpeg -i [path-to-promo-edit-final.mp4] \
     -c:v libx264 \
     -crf 23 \
     -preset medium \
     -vf "scale=1920:1080:force_original_aspect_ratio=decrease,pad=1920:1080:-1:-1:color=black" \
     -movflags +faststart \
     -c:a aac \
     -b:a 128k \
     public/assets/videos/promo-full.mp4
   ```

5. **Extract hero poster image** (from a well-composed frame, ~3 seconds in):
   ```bash
   ffmpeg -i public/assets/videos/hero-background.mp4 \
     -ss 00:00:03 \
     -frames:v 1 \
     -q:v 2 \
     public/assets/videos/hero-poster.jpg
   ```

6. **Extract promo poster image** (from a compelling frame, ~5 seconds in):
   ```bash
   ffmpeg -i public/assets/videos/promo-full.mp4 \
     -ss 00:00:05 \
     -frames:v 1 \
     -q:v 2 \
     public/assets/videos/promo-poster.jpg
   ```

7. **Verify file sizes:**
   ```bash
   ls -lh public/assets/videos/
   ```

   Confirm:
   - hero-background.mp4 is under 5MB
   - promo-full.mp4 is under 10MB
   - Total combined size is under 15MB

8. **If files are too large**, increase CRF value to 24 or 25 and re-encode:
   ```bash
   # Example with higher compression (CRF 24)
   ffmpeg -i [input] -c:v libx264 -crf 24 -preset medium -movflags +faststart [output]
   ```

9. **Preview videos** to ensure quality is acceptable:
   - Open each MP4 file in a video player
   - Check for compression artifacts in sky/gradient areas
   - Verify audio is clear and synchronized
  </what-human-does>
  <resume-signal>
Reply with "videos compressed" once all 4 files exist in public/assets/videos/:
- hero-background.mp4 (<5MB)
- hero-poster.jpg
- promo-full.mp4 (<10MB)
- promo-poster.jpg

If you encounter issues with file sizes or quality, describe the problem.
  </resume-signal>
</task>

</tasks>

<verification>
After user confirms completion:
- [ ] Directory public/assets/videos/ exists
- [ ] hero-background.mp4 exists and is under 5MB
- [ ] promo-full.mp4 exists and is under 10MB
- [ ] hero-poster.jpg exists
- [ ] promo-poster.jpg exists
- [ ] Combined video file size is under 15MB
</verification>

<success_criteria>
- All 4 files exist in public/assets/videos/
- Video files are in H.264/MP4 format with faststart flag for web streaming
- Hero video is under 5MB, promo video is under 10MB
- Poster images are high-quality JPEGs suitable for fallback display
- Videos maintain acceptable visual quality without obvious compression artifacts
</success_criteria>

<output>
After completion, create `.planning/phases/03-video-integration/03-01-SUMMARY.md`
</output>
